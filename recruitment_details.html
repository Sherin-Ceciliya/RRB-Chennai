<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CEN Recruitment Details</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="home.css" />
  <style>
    body { background-color: #f9f9f9; }
    .container { max-width: 1000px; margin: 30px auto; padding: 0 20px; }
    .section { background: white; padding: 20px; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); margin-bottom: 30px; }
    .section h2 { margin-top: 0; color: #0055a5; }
    .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px; margin-top: 10px; }
    .info-item { background: #eef5fb; padding: 12px 16px; border-radius: 4px; font-size: 0.95rem; }
    .info-item strong { display: block; font-size: 0.85rem; color: #444; margin-bottom: 4px; }
    .bulletin { margin-top: 10px; width: 100%; border-collapse: collapse; }
    .bulletin th, .bulletin td { padding: 12px 10px; border-bottom: 1px solid #ddd; text-align: left; }
    .bulletin th { background: #0055a5; color: white; }
    .btn-link { color: #0077c0; font-weight: bold; }
    .btn-link:hover { text-decoration: underline; }
    .custom-header { background-color: #153865; }
  </style>
</head>
<body class="bg-gray-100">

  <!-- Header -->
  <header class="custom-header text-white shadow-md">
    <div class="flex justify-between items-center h-32 w-full px-4">
      <div class="flex items-center space-x-4">
        <img src="images/railways.png" alt="RRB Logo" class="h-28 w-auto" />
        <div class="leading-tight">
          <h1 class="text-3xl font-bold">Railway Recruitment Board</h1>
          <p class="text-xl ml-1">Chennai</p>
        </div>
      </div>
      <nav class="hidden md:flex space-x-10 text-xl font-semibold">
        <a href="home.html" class="nav-link">Home</a>
        <a href="about.html" class="nav-link">About Us</a>
        <a href="results.html" class="nav-link">Results</a>
        <a href="recruitment.html" class="nav-link">Recruitments</a>
        <a href="contact.html" class="nav-link">Contact</a>
      </nav>
    </div>
  </header>

  <!-- Main -->
  <div class="container">
    <div class="section" id="recruitment-info">
      <h2 id="rec-title"></h2>
      <div class="info-grid">
        <div class="info-item"><strong>Opening Date</strong><span id="opening-date"></span></div>
        <div class="info-item"><strong>Closing Date</strong><span id="closing-date"></span></div>
        <div class="info-item"><strong>Last Updated</strong><span id="last-updated"></span></div>
        <div class="info-item"><strong>Status</strong><span id="status" style="font-weight:bold;"></span></div>
      </div>

      <style>
        .info-grid {
          display: grid;
          grid-template-columns: repeat(2, 1fr); /* 2 columns */
          gap: 16px;
          margin-top: 10px;
        }

        @media (max-width: 640px) {
          .info-grid {
            grid-template-columns: 1fr; /* stack on small screens */
          }
        }

        .info-item {
          background: #eef5fb;
          padding: 12px 16px;
          border-radius: 4px;
          font-size: 0.95rem;
        }

        .info-item strong {
          display: block;
          font-size: 0.85rem;
          color: #444;
          margin-bottom: 4px;
        }
      </style>

      <div class="description mt-4">
        <p id="description"></p>
      </div>
    </div>

    <div class="section">
      <h2>Bulletin Board</h2>
      <table class="bulletin">
        <thead>
          <tr><th>Title</th><th>Uploaded On</th><th>Link</th></tr>
        </thead>
        <tbody id="bulletin-body"></tbody>
      </table>
    </div>
  </div>

  <footer class="bg-gray-900 text-white py-8 mt-12">
    <div class="max-w-6xl mx-auto px-4 grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <h4 class="text-xl font-semibold mb-2">Government of India</h4>
        <p class="text-sm">Ministry of Railways</p>
        <p class="text-sm mt-1">For Enquiry call: <span class="font-medium">044 - 2827 5323</span></p>
      </div>
      <div class="flex flex-col items-start md:items-end">
        <h4 class="text-xl font-semibold mb-2">Quick Links</h4>
        <ul class="space-y-1 text-sm text-right w-full md:w-auto">
          <li><a href="#about" class="hover:text-gray-300">About Us</a></li>
          <li><a href="#results" class="hover:text-gray-300">Results</a></li>
          <li><a href="#recruitments" class="hover:text-gray-300">Recruitments</a></li>
          <li><a href="#contact" class="hover:text-gray-300">Contact Us</a></li>
        </ul>
      </div>
    </div>
    <div class="border-t border-gray-700 mt-6 pt-4 text-center text-sm text-gray-400">
      Â© 2025 Railway Recruitment Board Chennai. All Rights Reserved.
    </div>
  </footer>

  <!-- Script to Load JSON -->
  <script>
    // Get the CEN number from URL, e.g., ?cen=CEN_02_2025
    function getCENFromURL() {
      const params = new URLSearchParams(window.location.search);
      return params.get("cen");
    }

    async function loadRecruitment() {
      const cenNumber = getCENFromURL();
      if (!cenNumber) return;

      try {
        const response = await fetch("database.json");
        const data = await response.json();
        const rec = data[cenNumber];

        if (!rec) {
          document.getElementById("recruitment-info").innerHTML = "<p class='text-red-500'>No data found for this CEN.</p>";
          return;
        }

        // Populate main info
        document.getElementById("rec-title").textContent = rec.title;
        document.getElementById("opening-date").textContent = rec.opening_date;
        document.getElementById("closing-date").textContent = rec.closing_date;
        document.getElementById("last-updated").textContent = rec.last_updated;
        document.getElementById("status").textContent = rec.status;
        document.getElementById("status").style.color = rec.status === "Open" ? "green" : rec.status === "Upcoming" ? "orange" : "red";
        document.getElementById("description").textContent = rec.description;

        // Determine dynamic status based on closing date
        const closingDateParts = rec.closing_date.split('-'); // e.g., ["30", "June", "2025"]
        const months = { Jan:0, Feb:1, Mar:2, Apr:3, May:4, Jun:5, Jul:6, Aug:7, Sep:8, Sept:8, Oct:9, Nov:10, Dec:11 };
        const closingDate = new Date(
          parseInt(closingDateParts[2]), 
          months[closingDateParts[1].slice(0,3)], 
          parseInt(closingDateParts[0])
        );

        const today = new Date();
        let statusText, statusColor;

        if (closingDate < today) {
          statusText = "Closed";
          statusColor = "red";
        } else {
          statusText = "Open";
          statusColor = "green";
        }

        document.getElementById("status").textContent = statusText;
        document.getElementById("status").style.color = statusColor;


        // Populate bulletin table
        const tbody = document.getElementById("bulletin-body");
        tbody.innerHTML = ""; // clear existing rows
        rec.bulletin.forEach(item => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${item.title}</td>
            <td>${item.uploaded_on}</td>
            <td><a href="${item.link}" class="btn-link" target="_blank">View</a></td>
          `;
          tbody.appendChild(row);
        });

      } catch (err) {
        console.error(err);
        document.getElementById("recruitment-info").innerHTML = "<p class='text-red-500'>Failed to load recruitment data.</p>";
      }
    }

    loadRecruitment();
  </script>
</body>
</html>
