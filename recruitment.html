<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RRB Chennai</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="home.css" />
  <style>
    body { margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #fdfcf8; color: #333; line-height: 1.6; }
    header h1 { margin: 0; font-size: 2rem; }
    .container { max-width: 1100px; margin: auto; padding: 20px; }
    .section { margin-bottom: 40px; }
    .section h2 { color: #0055a5; border-bottom: 2px solid #ddd; padding-bottom: 8px; margin-bottom: 16px; font-weight: bold; font-size: 1.5rem; }
    .rules-box { background-color: #eef5fb; border-left: 5px solid #0077c0; padding: 15px 20px; margin-bottom: 20px; border-radius: 5px; }
    table { width: 100%; border-collapse: collapse; background-color: white; }
    th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd; }
    th { background-color: #0055a5; color: white; }
    tr:hover { background-color: #f1f1f1; }
    a.btn { display: inline-block; background-color: #0077c0; color: white; padding: 6px 12px; text-decoration: none; border-radius: 4px; transition: background-color 0.3s ease; }
    a.btn:hover { background-color: #004c87; }
    .rules-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 10px 40px; }
    .rules-grid a { display: block; color: #0083db; text-decoration: none; font-weight: bold; position: relative; padding-left: 15px; }
    .rules-grid a::before { content: 'тА║'; position: absolute; left: 0; color: #2196f3; }
    .rules-grid a:hover { text-decoration: underline; }
    .status-open { color: green; font-weight: bold; }
    .status-closed { color: red; font-weight: bold; }
    .status-upcoming { color: goldenrod; font-weight: bold; }
    .custom-header { background-color: #153865; }
    .nav-link { position: relative; padding-bottom: 4px; transition: color 0.3s ease-in-out; }
    .nav-link::after { content: ''; position: absolute; width: 0%; height: 2px; left: 0; bottom: 0; background-color: white; transition: width 1s ease; }
    .nav-link:hover::after { width: 100%; }
    @media (max-width: 768px) { th, td { font-size: 0.95rem; } header h1 { font-size: 1.6rem; } .rules-box { font-size: 0.95rem; } }
  </style>
</head>
<body class="bg-gray-100">

<header class="custom-header text-white shadow-md">
  <div class="flex justify-between items-center h-32 w-full px-4">
    <div class="flex items-center space-x-4">
      <img src="images/railways.png" alt="RRB Logo" class="h-28 w-auto" />
      <div class="leading-tight">
        <h1 class="text-3xl font-bold" id="headerTitle">Railway Recruitment Board</h1>
        <p class="text-xl ml-1" id="headerSubtitle">Chennai</p>
      </div>
    </div>
    <nav class="hidden md:flex space-x-10 text-xl font-semibold">
      <a href="home.html" class="nav-link" id="navHome">Home</a>
      <a href="about.html" class="nav-link" id="navAbout">About Us</a>
      <a href="results.html" class="nav-link" id="navResults">Results</a>
      <a href="recruitment.html" class="nav-link" id="navRecruitments">Recruitments</a>
      <a href="contact.html" class="nav-link" id="navContact">Contact</a>
    </nav>
  </div>
</header>

<div class="container">
  <section class="section">
    <h2 id="welcomeTitle">Welcome to the Recruitment Portal</h2>
    <p id="welcomeText">This portal provides all the latest updates regarding recruitments conducted by the Railway Recruitment Board (RRB), Chennai.</p>
  </section>

  <section class="section">
    <h2 id="rulesTitle">Recruitment Rules</h2>
    <div class="rules-box" id="rulesBox">All appointments made through this board will strictly adhere to the guidelines laid down by the Ministry of Railways.</div>
    <div class="rules-grid" id="rulesGrid">
      <a href="./resources/results.pdf">General Instructions</a>
      <a href="./resources/results.pdf">Serving Employees</a>
      <a href="./resources/results.pdf">Age Relaxation</a>
      <a href="./resources/results.pdf">Miscellaneous</a>
      <a href="./resources/results.pdf">Examination Fees</a>
      <a href="./resources/results.pdf">Impersonation Supression of Facts</a>
      <a href="./resources/results.pdf">Community Reservation</a>
      <a href="./resources/results.pdf">Facilities for SC / ST Candidates</a>
      <a href="./resources/results.pdf">Recruitment Process</a>
      <a href="./resources/results.pdf">Warning</a>
      <a href="./resources/results.pdf">Medical Standard</a>
      <a href="./resources/results.pdf">Frequently Committed Mistakes</a>
      <a href="./resources/results.pdf">Ex-serviceman & Persons With Disabilities</a>
      <a href="./archives.html">Archives</a>
    </div>
  </section>

  <section class="section">
    <h2 id="openingsTitle">Current Openings</h2>
    <table>
      <thead>
        <tr>
          <th id="colCEN">CEN No.</th>
          <th id="colRole">Recruitment Role</th>
          <th id="colOpenDate">Opening Date</th>
          <th id="colCloseDate">Closing Date</th>
          <th id="colStatus">Status</th>
          <th id="colDetails">Details</th>
        </tr>
      </thead>
      <tbody id="recruitment-body"></tbody>
    </table>
  </section>
</div>

<footer class="bg-gray-900 text-white py-8 mt-12">
  <div class="max-w-6xl mx-auto px-4 grid grid-cols-1 md:grid-cols-2 gap-6">
    <div>
      <h4 class="text-xl font-semibold mb-2" id="footerGov">Government of India</h4>
      <p class="text-sm" id="footerMinistry">Ministry of Railways</p>
      <p class="text-sm mt-1" id="footerEnquiry">For Enquiry call: <span class="font-medium">044 - 2827 5323</span></p>
    </div>
    <div class="flex flex-col items-start md:items-end">
      <h4 class="text-xl font-semibold mb-2" id="footerQuick">Quick Links</h4>
      <ul class="space-y-1 text-sm text-right w-full md:w-auto">
        <li><a href="#about" class="hover:text-gray-300 transition-colors" id="quickAbout">About Us</a></li>
        <li><a href="#results" class="hover:text-gray-300 transition-colors" id="quickResults">Results</a></li>
        <li><a href="#recruitments" class="hover:text-gray-300 transition-colors" id="quickRecruitments">Recruitments</a></li>
        <li><a href="#contact" class="hover:text-gray-300 transition-colors" id="quickContact">Contact Us</a></li>
      </ul>
    </div>
  </div>
  <div class="border-t border-gray-700 mt-6 pt-4 text-center text-sm text-gray-400" id="footerCopy">┬й 2022 Railway Recruitment Board Chennai. All Rights Reserved.</div>
</footer>

<script>
// ЁЯФ╣ Static texts for English and Tamil
const staticText = {
  en: {
    headerTitle:"Railway Recruitment Board",headerSubtitle:"Chennai",navHome:"Home",navAbout:"About Us",
    navResults:"Results",navRecruitments:"Recruitments",navContact:"Contact",
    welcomeTitle:"Welcome to the Recruitment Portal",welcomeText:"This portal provides all the latest updates regarding recruitments conducted by the Railway Recruitment Board (RRB), Chennai.",
    rulesTitle:"Recruitment Rules",rulesBox:"All appointments made through this board will strictly adhere to the guidelines laid down by the Ministry of Railways.",
    openingsTitle:"Current Openings",colCEN:"CEN No.",colRole:"Recruitment Role",colOpenDate:"Opening Date",
    colCloseDate:"Closing Date",colStatus:"Status",colDetails:"Details",footerGov:"Government of India",footerMinistry:"Ministry of Railways",
    footerEnquiry:"For Enquiry call: 044 - 2827 5323",footerQuick:"Quick Links",quickAbout:"About Us",quickResults:"Results",
    quickRecruitments:"Recruitments",quickContact:"Contact Us",footerCopy:"┬й 2022 Railway Recruitment Board Chennai. All Rights Reserved.",
    open:"Open",closed:"Closed",upcoming:"Upcoming",view:"View"
  },
  ta: {
    headerTitle:"ро░ропро┐ро▓рпНро╡рпЗ роЖроЯрпНроЪрпЗро░рпНрокрпНрокрпБ ро╡ро╛ро░ро┐ропроорпН",headerSubtitle:"роЪрпЖройрпНройрпИ",navHome:"роорпБроХрокрпНрокрпБ",navAbout:"роОроЩрпНроХро│рпИ рокро▒рпНро▒ро┐",
    navResults:"родрпЗро░рпНро╡рпБ роорпБроЯро┐ро╡рпБроХро│рпН",navRecruitments:"роЖроЯрпНроЪрпЗро░рпНрокрпНрокрпБроХро│рпН",navContact:"родрпКроЯро░рпНрокрпБ",
    welcomeTitle:"роЖроЯрпНроЪрпЗро░рпНрокрпНрокрпБ родро│родрпНродро┐ро▒рпНроХрпБ ро╡ро░ро╡рпЗро▒рпНроХро┐ро▒рпЛроорпН",welcomeText:"роЗроирпНрод родро│роорпН роЪрпЖройрпНройрпИ ро░ропро┐ро▓рпНро╡рпЗ роЖроЯрпНроЪрпЗро░рпНрокрпНрокрпБ ро╡ро╛ро░ро┐ропродрпНродро╛ро▓рпН роироЯродрпНродрокрпНрокроЯрпБроорпН роЕройрпИродрпНродрпБ роЖроЯрпНроЪрпЗро░рпНрокрпНрокрпБроХро│ро┐ройрпН роЪроорпАрокродрпНродро┐роп родроХро╡ро▓рпНроХро│рпИропрпБроорпН ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ.",
    rulesTitle:"роЖроЯрпНроЪрпЗро░рпНрокрпНрокрпБ ро╡ро┐родро┐роХро│рпН",rulesBox:"роЗроирпНрод ро╡ро╛ро░ро┐ропродрпНродро┐ройрпН роорпВро▓роорпН роЪрпЖропрпНропрокрпНрокроЯрпНроЯ роЕройрпИродрпНродрпБ роиро┐ропрооройроЩрпНроХро│рпБроорпН ро░ропро┐ро▓рпНро╡рпЗ роЕроорпИроЪрпНроЪроХроорпН ро╡роХрпБродрпНрод ро╡ро┤ро┐роХро╛роЯрпНроЯрпБродро▓рпНроХро│рпИроХрпН роХроЯрпИрокрпНрокро┐роЯро┐роХрпНроХрпБроорпН.",
    openingsTitle:"родро▒рпНрокрпЛродрпИроп родро┐ро▒роирпНрод рокрогро┐ропро┐роЯроЩрпНроХро│рпН",colCEN:"CEN роОрогрпН",colRole:"роЖроЯрпНроЪрпЗро░рпНрокрпНрокрпБ рокрогро┐",colOpenDate:"родро┐ро▒рокрпНрокрпБ родрпЗродро┐",
    colCloseDate:"роорпВроЯрпБроорпН родрпЗродро┐",colStatus:"роиро┐ро▓рпИ",colDetails:"ро╡ро┐ро╡ро░роЩрпНроХро│рпН",footerGov:"роЗроирпНродро┐роп роЕро░роЪрпБ",footerMinistry:"ро░ропро┐ро▓рпНро╡рпЗ роЕроорпИроЪрпНроЪроХроорпН",
    footerEnquiry:"ро╡ро┐роЪро╛ро░рогрпИроХрпНроХрпБ роЕро┤рпИроХрпНроХро╡рпБроорпН: 044 - 2827 5323",footerQuick:"ро╡ро┐ро░рпИро╡рпБ роЗрогрпИрокрпНрокрпБроХро│рпН",quickAbout:"роОроЩрпНроХро│рпИ рокро▒рпНро▒ро┐",
    quickResults:"родрпЗро░рпНро╡рпБ роорпБроЯро┐ро╡рпБроХро│рпН",quickRecruitments:"роЖроЯрпНроЪрпЗро░рпНрокрпНрокрпБроХро│рпН",quickContact:"родрпКроЯро░рпНрокрпБ",
    footerCopy:"┬й 2022 ро░ропро┐ро▓рпНро╡рпЗ роЖроЯрпНроЪрпЗро░рпНрокрпНрокрпБ ро╡ро╛ро░ро┐ропроорпН роЪрпЖройрпНройрпИ. роЕройрпИродрпНродрпБ роЙро░ро┐роорпИроХро│рпБроорпН рокро╛родрпБроХро╛роХрпНроХрокрпНрокроЯрпНроЯро╡рпИ.",
    open:"родро┐ро▒роирпНродрпБро│рпНро│родрпБ",closed:"роорпВроЯрокрпНрокроЯрпНроЯрпБро╡ро┐роЯрпНроЯродрпБ",upcoming:"ро╡ро┐ро░рпИро╡ро┐ро▓рпН",view:"рокро╛ро░рпНро╡рпИропро┐роЯрпБ"
  }
};

// ЁЯФ╣ Rule links for both languages
const ruleLinks = {
  en:["General Instructions","Serving Employees","Age Relaxation","Miscellaneous","Examination Fees","Impersonation Supression of Facts","Community Reservation","Facilities for SC / ST Candidates","Recruitment Process","Warning","Medical Standard","Frequently Committed Mistakes","Ex-serviceman & Persons With Disabilities","Archives"],
  ta:["рокрпЖро╛родрпБ ро╡ро┤ро┐роорпБро▒рпИроХро│рпН","рокрогро┐ропро╛ро▒рпНро▒рпБроорпН роКро┤ро┐ропро░рпНроХро│рпН","ро╡ропродрпБ родро│ро░рпНро╡рпБ","рокро▓ро╡роХрпИ","родрпЗро░рпНро╡рпБ роХроЯрпНроЯрогроорпН","роирокро░рпН рокрпЖропро░рпН роорпЛроЪроЯро┐","роЪроорпВроХ роТродрпБроХрпНроХрпАроЯрпБ","SC / ST ро╡рпЗроЯрпНрокро╛ро│ро░рпНроХро│рпБроХрпНроХро╛рой ро╡роЪродро┐роХро│рпН","роЖроЯрпНроЪрпЗро░рпНрокрпНрокрпБ роЪрпЖропро▓рпНроорпБро▒рпИ","роОроЪрпНроЪро░ро┐роХрпНроХрпИ","рооро░рпБродрпНродрпБро╡ родро░роорпН","роЕроЯро┐роХрпНроХроЯро┐ роПро▒рпНрокроЯрпБроорпН рокро┐ро┤рпИроХро│рпН","роорпБройрпНройро╛ро│рпН ро╡рпАро░ро░рпНроХро│рпН & рооро╛ро▒рпНро▒рпБродрпНродро┐ро▒ройро╛ро│ро┐роХро│рпН","роЖро╡рогроХрпН роХро╛рокрпНрокроХроорпН"]
};

// ЁЯФ╣ Tamil & English month mapping
const monthMap = {
  jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11,
  "роЬройро╡ро░ро┐":0,"рокро┐рокрпНро░ро╡ро░ро┐":1,"рооро╛ро░рпНроЪрпН":2,"роПрокрпНро░ро▓рпН":3,"роорпЗ":4,"роЬрпВройрпН":5,"роЬрпВро▓рпИ":6,"роЖроХро╕рпНроЯрпН":7,
  "роЪрпЖрокрпНроЯроорпНрокро░рпН":8,"роЕроХрпНроЯрпЛрокро░рпН":9,"роиро╡роорпНрокро░рпН":10,"роЯро┐роЪроорпНрокро░рпН":11
};

// ЁЯФ╣ Apply static texts to page
function applyStaticTexts(lang) {
  const map = staticText[lang];
  for (const id in map) {
    const el = document.getElementById(id);
    if (el) el.innerText = map[id];
  }
  const anchors = document.querySelectorAll("#rulesGrid a");
  anchors.forEach((a,i)=>{ if(ruleLinks[lang]&&ruleLinks[lang][i]) a.innerText=ruleLinks[lang][i]; });
}

// ЁЯФ╣ Parse date strings including Tamil months
function parseDateString(str) {
  if(!str || typeof str !== "string") return null;
  str = str.trim();
  const match = str.match(/^(\d{1,2})[-\/ ](.+)[-\/ ](\d{4})$/);
  if(match) {
    const day = parseInt(match[1],10);
    const monthRaw = match[2].trim();
    const year = parseInt(match[3],10);
    const month = monthMap[monthRaw];
    if(!isNaN(day) && !isNaN(year) && month !== undefined){
      return new Date(year, month, day);
    }
  }
  const d = new Date(str);
  return isNaN(d)?null:new Date(d.getFullYear(), d.getMonth(), d.getDate());
}

// ЁЯФ╣ Normalize date to YYYY-MM-DD
function normalizeDate(d) {
  return d instanceof Date && !isNaN(d) ? new Date(d.getFullYear(), d.getMonth(), d.getDate()) : null;
}

// ЁЯФ╣ Determine recruitment status
function getStatus(opening, closing) {
  const today = normalizeDate(new Date());
  const openDate = normalizeDate(opening);
  const closeDate = normalizeDate(closing);

  if (openDate && closeDate) {
    if (today < openDate) return "upcoming";
    if (today > closeDate) return "closed";
    return "open";
  } else if (openDate && !closeDate) {
    return today < openDate ? "upcoming" : "open";
  } else if (!openDate && closeDate) {
    return today > closeDate ? "closed" : "open";
  } else {
    return "closed";
  }
}

// ЁЯФ╣ Escape HTML for safe rendering
function escapeHtml(str){ 
  if(typeof str!=="string") return str===null||str===undefined?"":str.toString(); 
  return str.replace(/[&<>"']/g,function(m){return({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]);}); 
}

// ЁЯФ╣ Load recruitment data and render table
async function loadRecruitmentData(file, lang){
  const tbody = document.getElementById("recruitment-body");
  tbody.innerHTML = "";
  try {
    const response = await fetch(file,{cache:"no-store"});
    if(!response.ok) throw new Error("HTTP "+response.status);
    const data = await response.json();
    const keys = Object.keys(data);
    if(keys.length === 0){ tbody.innerHTML=`<tr><td colspan="6">No recruitment data available.</td></tr>`; return; }

    keys.forEach(key=>{
      const record = data[key];
      const openDate = parseDateString(record.opening_date);
      const closeDate = parseDateString(record.closing_date);
      const statusKey = getStatus(openDate, closeDate);
      const displayStatus = staticText[lang][statusKey];
      let statusClass="status-closed"; 
      if(statusKey==="open") statusClass="status-open"; 
      else if(statusKey==="upcoming") statusClass="status-upcoming";

      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${key}</td>
                      <td>${escapeHtml(record.title||"")}</td>
                      <td>${escapeHtml(record.opening_date||"")}</td>
                      <td>${escapeHtml(record.closing_date||"")}</td>
                      <td class="${statusClass}">${escapeHtml(displayStatus)}</td>
                      <td><a class="btn" href="recruitment_details.html?cen=${encodeURIComponent(key)}">${escapeHtml(staticText[lang].view)}</a></td>`;
      tbody.appendChild(tr);
    });

  } catch(err){
    console.error("Error loading recruitment data:",err);
    tbody.innerHTML=`<tr><td colspan="6">Failed to load recruitment data.</td></tr>`;
  }
}

// ЁЯФ╣ Initialize page
document.addEventListener("DOMContentLoaded",()=>{
  const lang = sessionStorage.getItem("lang") || "en";
  applyStaticTexts(lang);
  loadRecruitmentData(lang==="ta"?"./database_ta.json":"./database.json", lang);
});
</script>


</body>
</html>
